<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Create Order</title>
</head>
<body>
<h1>Create Order</h1>

<form action="#" th:action="@{/orders/add}" th:object="${orders}" method="post">
    <div>
        <label for="customer">Customer:</label>
        <select id="customer" th:field="*{custNo}">
            <option th:each="customer : ${customers}"
                    th:value="${customer.custNo}"
                    th:text="${customer.company}">Customer Name</option>
        </select>
    </div>

    <!-- Контейнер для нових Items -->
    <div id="items-container"></div>

    <button type="button" onclick="addItem()">Add Item</button>
    <div>
        <button type="submit">Submit Order</button>
    </div>
</form>

<!-- Прихований шаблон для створення нових Items -->
<div id="item-template" style="display:none;">
    <div class="item-container">
        <h3>Item</h3>
        <div>
            <label for="itemNo">Item No:</label>
            <input type="text" id="itemNo" readonly />
        </div>
        <div>
            <label for="quantity">Quantity:</label>
            <input type="number" id="quantity" />
        </div>
        <div>
            <label for="cost">Price:</label>
            <input type="text" id="cost" />
        </div>
        <button type="button" onclick="removeItem(this)">Remove Item</button>
    </div>
</div>

<script>
    (function() {
        let itemIndex = 0;

        window.addItem = function() {
            const itemTemplate = document.querySelector('#item-template .item-container');
            const newItem = itemTemplate.cloneNode(true);

            // Оновлення імен полів
            newItem.querySelectorAll('input').forEach(input => {
                const id = input.getAttribute('id');
                input.name = `items[${iIndex}].${id}`;
                if (id === 'itemNo') {
                    input.value = iIndex + 1; // інкрементне значення для itemNo
                }
            });

            document.querySelector('#items-container').appendChild(newItem);
            iIndex++;
        }

        window.removeItem = function(button) {
            const itemContainer = button.closest('.item-container');
            itemContainer.remove();
        }
    })();
</script>
</body>
</html>
